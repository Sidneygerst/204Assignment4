---
title: "Assignment 4"
author: "Sidney Gerst, Natalie Dornan"
date: "May 30, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include = FALSE}

#load packages
library(tidyverse)
library(janitor)

#load and tidy the data

hw4 <- read_csv("HW4Data.csv") %>%
  clean_names()

#abatement is quantity. the reduction from current carbon emissions


```

###1. Marginal Cost of Abatement

####Sector A
```{r include = FALSE, message= FALSE}

#Regression analysis for Sector A(how does the data look graphically?)
plot_a <- ggplot(hw4, aes(x = abatement, y = mc_a)) +
  geom_point() +
  geom_smooth()

plot_a #looks very linear

#bc the data looks linear, use a linear regression

lm_a <- lm(mc_a ~ abatement, data = hw4)

lm_a
# Coefficients:
# (Intercept)    abatement  
#     -8.6445       0.5768 

#store the coefficients 

int_a <- lm_a$coefficients[1]
slope_a <- lm_a$coefficients[2]


```

<br>
$Marginal~Cost~of~Abatement~Sector~A = `r slope_a`*q + `r int_a`$

<br>

####Sector B 
```{r include = FALSE, message= FALSE}

#Regression analysis for Sector B(how does the data look graphically?)
plot_b <- ggplot(hw4, aes(x = abatement, y = mc_b)) +
  geom_point() +
  geom_smooth()

plot_b #looks very logistic, but sam is going to use a linear model so we will as well !

#if we really want to we can use a logit regression LATER

lm_b <- lm(mc_b ~ abatement, data = hw4)

lm_b
# Coefficients:
# (Intercept)    abatement  
#      9.3177       0.1987 

#store the coefficients 

int_b <- lm_b$coefficients[1]
slope_b <- lm_b$coefficients[2]


```

<br>
$Marginal~Cost~of~Abatement~Sector~B = `r slope_b`*q + `r int_b`$

<br>

####Sector C
```{r include= FALSE, message= FALSE}

#Regression analysis for Sector B(how does the data look graphically?)
plot_c <- ggplot(hw4, aes(x = abatement, y = mc_c)) +
  geom_point() +
  geom_smooth()

plot_c #looks very exponetial, but again, Sam said he was going to use lineal for all to make it easier on us later



lm_c <- lm(mc_c ~ abatement, data = hw4)

lm_c
# Coefficients:
# (Intercept)    abatement  
#    -11.6550       0.7838 

#store the coefficients 

int_c <- lm_c$coefficients[1]
slope_c <- lm_c$coefficients[2]



```

<br>
$Marginal~Cost~of~Abatement~Sector~C = `r slope_c`*q + `r int_c`$

<br>

####Sector D
```{r include=FALSE, message=FALSE}

#Regression analysis for Sector B(how does the data look graphically?)
plot_d <- ggplot(hw4, aes(x = abatement, y = mc_d)) +
  geom_point() +
  geom_smooth()

plot_d #looks very exponetial, but again, Sam said he was going to use lineal for all to make it easier on us later



lm_d <- lm(mc_d ~ abatement, data = hw4)

lm_d
# Coefficients:
# (Intercept)    abatement  
#      9.6875       0.2599  

#store the coefficients 

int_d <- lm_d$coefficients[1]
slope_d <- lm_d$coefficients[2]


```

<br>
$Marginal~Cost~of~Abatement~Sector~D = `r slope_d`*q + `r int_c`$

<br>

####Plot all functions
```{r echo=FALSE, message=FALSE}

#need to figure out how to plot multiple regressions onto one plot
all_curves <- qplot(x=mc_d, y=abatement, data=hw4)+
  geom_abline(aes(intercept=int_a, slope=slope_a, col = "red"), data=lm_a) +
  geom_abline(aes(intercept = int_b, slope=slope_b, col = "green"), data= lm_b) +
  geom_abline(aes(intercept = int_c, slope = slope_c, col = "blue"), data= lm_c) +
  geom_abline(aes(intercept = int_d, slope = slope_d, col = "yellow"), data = lm_d) +
  theme_bw()

all_curves

```

###2. Demand Curves of carbon emissions

<br>

####Sector A
```{r echo=FALSE}

#emissions for sector A are 180. we need to make a sequence from 0-180 by 10
quant_a <- seq(0,180,by=10)


#create a function for sector A demand curve 

demand_a <- function(q){
  (slope_a*(180-q)) + int_a
}

# Derive demand curve using the values above
d_a <- demand_a(quant_a)

#willing to pay 95.2 for the first ton of emissions 

# Graph it to see if this worked....
curve(demand_a, from=0, to=180, xlab = "x", ylab = "y")


```

 
Plugging in 0 for q will result in the willingness to pay for the right to pollute the first unit.
Sector A:  $Price~of~Emissions = `r slope_a`*(180-q) + `r int_a`$  
$Willingness~to~Pay~for~First~Unit = \$95.2$ 

<br>

#####Sector B
```{r echo = FALSE }
#emissions for sector A are 180. we need to make a sequence from 0-180 by 10
quant_b <- seq(0,200,by=10)


#create a function for sector A demand curve 

demand_b <- function(q){
  (slope_b*(200-q)) + int_b
}

# Derive demand curve using the values above
d_b <- demand_b(quant_b)

#willing to pay 95.2 for the first ton of emissions 

# Graph it to see if this worked....
curve(demand_b, from=0, to=200, xlab = "x", ylab = "y")
```

  
$Price~of~Emissions = `r slope_b`*(180-q) + `r int_b`$  
$Willingness~to~Pay~for~First~Unit = \$49.1$ 

<br>

#####Sector C
```{r echo = FALSE}
#emissions for sector A are 180. we need to make a sequence from 0-180 by 10
quant_c <- seq(0,220,by=10)


#create a function for sector A demand curve 

demand_c <- function(q){
  (slope_c*(220-q)) + int_c}

# Derive demand curve using the values above
d_c <- demand_c(quant_c)

#willing to pay 95.2 for the first ton of emissions 

# Graph it to see if this worked....
curve(demand_c, from=0, to=220, xlab = "x", ylab = "y")
```

$Price~of~Emissions = `r slope_c`*(180-q) + `r int_c`$  
$Willingness~to~Pay~for~First~Unit = \$161$ 

<br>

#####Sector D
```{r echo = FALSE }
#emissions for sector A are 180. we need to make a sequence from 0-180 by 10
quant_d <- seq(0,300,by=10)


#create a function for sector A demand curve 

demand_d <- function(q){
  (slope_d*(300-q)) + int_d
}

# Derive demand curve using the values above
d_d <- demand_d(quant_d)

#willing to pay 95.2 for the first ton of emissions 

# Graph it to see if this worked....
curve(demand_d, from=0, to=300, xlab = "x", ylab = "y")

```

$Price~of~Emissions = `r slope_d`*(180-q) + `r int_d`$  
$Willingness~to~Pay~for~First~Unit = \$87.7$

<br> 

###3. Country X

####a. Cap on Carbon A. 

```{r echo = FALSE}

#aggregate the costs of A, B, and C
#create functions of individual cost curves
lm_func_a <- function(q){
  slope_a*q + int_a
}



lm_func_b <- function(q){
  slope_b*q +int_b
}

lm_func_c <- function(q){
  slope_c*q + int_c
}

countryx <- function(q){
  
  lm_func_a(q) + lm_func_b(q) + lm_func_c(q)
  
}

curve(countryx, from=0, to=600, xlab = "x", ylab = "y")

#QUESTION: Do we just cut the aggregate cost curve by 100? 
#is the price at 300 above the intercept for any of the sectors?

```


<br>

####b. Tax on Carbon
```{r echo = FALSE }

#plug 300 into x for the countryx function

#first need to find y=mx+b

#how do?!!?!?!??!?!?!?




```


<br>

####c. Cap AND Trade
```{r echo = FALSE }





```

